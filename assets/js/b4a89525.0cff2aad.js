"use strict";(self.webpackChunkmirage_docs=self.webpackChunkmirage_docs||[]).push([[9600],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>m});var a=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var i=a.createContext({}),c=function(e){var n=a.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},d=function(e){var n=c(e.components);return a.createElement(i.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),u=c(t),m=r,g=u["".concat(i,".").concat(m)]||u[m]||p[m]||o;return t?a.createElement(g,l(l({ref:n},d),{},{components:t})):a.createElement(g,l({ref:n},d))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,l=new Array(o);l[0]=u;var s={};for(var i in n)hasOwnProperty.call(n,i)&&(s[i]=n[i]);s.originalType=e,s.mdxType="string"==typeof e?e:r,l[1]=s;for(var c=2;c<o;c++)l[c]=t[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},10719:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var a=t(87462),r=(t(67294),t(3905));const o={title:"Network Scene Manager"},l="Using Network Scene Manager",s={unversionedId:"guides/scene-loading/network-scene-manager",id:"guides/scene-loading/network-scene-manager",title:"Network Scene Manager",description:"NetworkSceneManager contains methods and logic to help keep the scene in sync between server and client.",source:"@site/docs/guides/scene-loading/network-scene-manager.md",sourceDirName:"guides/scene-loading",slug:"/guides/scene-loading/network-scene-manager",permalink:"/Mirage/docs/guides/scene-loading/network-scene-manager",draft:!1,editUrl:"https://github.com/MirageNet/Mirage/tree/main/doc/docs/guides/scene-loading/network-scene-manager.md",tags:[],version:"current",frontMatter:{title:"Network Scene Manager"},sidebar:"docs",previous:{title:"Manual Scene Loading",permalink:"/Mirage/docs/guides/scene-loading/manual-scene-loading"},next:{title:"Serialization",permalink:"/Mirage/docs/guides/serialization/"}},i={},c=[{value:"How to use",id:"how-to-use",level:3},{value:"Load Scene Normally",id:"load-scene-normally",level:2},{value:"Load Scene Additively",id:"load-scene-additively",level:2},{value:"Virtual Methods",id:"virtual-methods",level:2},{value:"Example - OnServerAuthenticated",id:"example---onserverauthenticated",level:3},{value:"Example - Start",id:"example---start",level:3},{value:"Example - OnDestroy",id:"example---ondestroy",level:3}],d={toc:c};function p(e){let{components:n,...t}=e;return(0,r.kt)("wrapper",(0,a.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"using-network-scene-manager"},"Using Network Scene Manager"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/docs/reference/Mirage/NetworkSceneManager"},"NetworkSceneManager")," contains methods and logic to help keep the scene in sync between server and client."),(0,r.kt)("admonition",{title:"Work In Progress",type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"This page is a work in progress")),(0,r.kt)("h3",{id:"how-to-use"},"How to use"),(0,r.kt)("p",null,"The Network Scene Manager takes care of most of the grunt work that is needed to load unload and network scenes between server and client. The examples below show exactly how to use\nthe network scene manager."),(0,r.kt)("h2",{id:"load-scene-normally"},"Load Scene Normally"),(0,r.kt)("p",null,"This will load up a new scene on the server and tell all current player's loaded on the server to load the scene up."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},'public class LoadScene : MonoBehaviour\n{\n    public void Start()\n    {\n        NetworkSceneManager sceneManager = GetComponent<NetworkSceneManager>();\n\n        sceneManager.ServerLoadSceneNormal("path to scene asset file.")\n    }\n}\n')),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"If you require physics scenes to load up on the server you can override the default parameter like so.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},'sceneManager.ServerLoadSceneNormal("path to scene asset file.", new LoadSceneParameters { loadSceneMode = LoadSceneMode.Normal, localPhysicsMode = LocalPhysicsMode.Physics2D });\n')),(0,r.kt)("h2",{id:"load-scene-additively"},"Load Scene Additively"),(0,r.kt)("p",null,"This will load a scene additively on the server and tell specific clients to do the same. Example shows send to everyone."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},'public class LoadSceneAdditively : MonoBehaviour\n{\n    public void Start()\n    {\n        NetworkSceneManager sceneManager = GetComponent<NetworkSceneManager>();\n\n        sceneManager.ServerLoadSceneAdditively("path to scene asset file.", sceneManager.Server.Players)\n    }\n}\n')),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"If you want to send the additive scene to only specific players we can do it like so. You must get the player on your own.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},'sceneManager.ServerLoadSceneAdditively("path to scene asset file.", Player)\n')),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Also if you want to load the scene normally to specific players versus additively like the server you can override the parameter to do so also. The server will still\nload additively, the reason is if you need fully normal loading you can use the above method instead to do it.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},'sceneManager.ServerLoadSceneAdditively("path to scene asset file.", Player, true)\n')),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Also if you want to load the scene in physic's mode you can override another parameter also to do so. You can also make clients load normally in the example below we keep it false to load\nthe client side additively too.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},'sceneManager.ServerLoadSceneAdditively("path to scene asset file.", Player, false, new LoadSceneParameters { loadSceneMode = LoadSceneMode.Additively, localPhysicsMode = LocalPhysicsMode.Physics2D )\n')),(0,r.kt)("p",null,"This will unload a scene additively on the server and tell specific clients to do the same. Example shows send to everyone."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},'public class UnLoadSceneAdditively : MonoBehaviour\n{\n    public void Start()\n    {\n        NetworkSceneManager sceneManager = GetComponent<NetworkSceneManager>();\n\n        sceneManager.ServerUnloadSceneAdditively("path to scene asset file.", sceneManager.Server.Players)\n    }\n}\n')),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"If you want to send the additive scene to only specific players we can do it like so. You must get the player on your own.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},'sceneManager.ServerLoadSceneAdditively("path to scene asset file.", Player)\n')),(0,r.kt)("h2",{id:"virtual-methods"},"Virtual Methods"),(0,r.kt)("p",null,"Some of the methods in NetworkSceneManager can be overridden to customize how it works"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Start"),(0,r.kt)("li",{parentName:"ul"},"OnDestroy"),(0,r.kt)("li",{parentName:"ul"},"ClientStartSceneMessage"),(0,r.kt)("li",{parentName:"ul"},"ClientFinishedLoadingSceneMessage"),(0,r.kt)("li",{parentName:"ul"},"ClientNotReadyMessage"),(0,r.kt)("li",{parentName:"ul"},"OnServerAuthenticated"),(0,r.kt)("li",{parentName:"ul"},"OnServerPlayerDisconnected")),(0,r.kt)("h3",{id:"example---onserverauthenticated"},"Example - OnServerAuthenticated"),(0,r.kt)("p",null,"By default OnServerAuthenticated sends the active scene and all additive scenes to the client, It can be overridden to only send the active scene:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},"public class MySceneManager : NetworkSceneManager\n{\n    protected internal override void OnServerAuthenticated(INetworkPlayer player)\n    {\n        // just load server's active scene instead of all additive scenes as well\n        player.Send(new SceneMessage { MainActivateScene = ActiveScenePath });\n        player.Send(new SceneReadyMessage());\n    }\n}\n")),(0,r.kt)("h3",{id:"example---start"},"Example - Start"),(0,r.kt)("p",null,"By default, ",(0,r.kt)("inlineCode",{parentName:"p"},"Start")," registers all our listeners for scene management handling. If you need to override it then do this and add your stuff."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},"public class MySceneManager : NetworkSceneManager\n{\n    protected internal override void Start()\n    {\n        // add your stuff before.\n\n        base.Start();\n\n        // add your stuff after.\n    }\n}\n")),(0,r.kt)("h3",{id:"example---ondestroy"},"Example - OnDestroy"),(0,r.kt)("p",null,"By default OnDestroy de-registers all our listener's for scene management handling. If you need to override it then do this and add your stuff."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},"public class MySceneManager : NetworkSceneManager\n{\n    protected internal override void OnDestroy()\n    {\n        // add your stuff before.\n\n        base.OnDestroy();\n\n        // add your stuff after.\n    }\n}\n")))}p.isMDXComponent=!0}}]);