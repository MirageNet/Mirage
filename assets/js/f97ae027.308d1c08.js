"use strict";(self.webpackChunkmirage_docs=self.webpackChunkmirage_docs||[]).push([[406],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>u});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var i=a.createContext({}),d=function(e){var t=a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=d(e.components);return a.createElement(i.Provider,{value:t},e.children)},y={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=d(n),u=r,m=p["".concat(i,".").concat(u)]||p[u]||y[u]||o;return n?a.createElement(m,s(s({ref:t},c),{},{components:n})):a.createElement(m,s({ref:t},c))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,s=new Array(o);s[0]=p;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l.mdxType="string"==typeof e?e:r,s[1]=l;for(var d=2;d<o;d++)s[d]=n[d];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},93370:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>y,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var a=n(87462),r=(n(67294),n(3905));const o={sidebar_position:14},s="Ready Check and Lobby Ready",l={unversionedId:"components/ready-check",id:"components/ready-check",title:"Ready Check and Lobby Ready",description:"See the API reference for more details",source:"@site/docs/components/ready-check.md",sourceDirName:"components",slug:"/components/ready-check",permalink:"/Mirage/docs/components/ready-check",draft:!1,editUrl:"https://github.com/MirageNet/Mirage/tree/main/doc/docs/components/ready-check.md",tags:[],version:"current",sidebarPosition:14,frontMatter:{sidebar_position:14},sidebar:"docs",previous:{title:"Network Discovery",permalink:"/Mirage/docs/components/network-discovery"},next:{title:"Network Log Settings",permalink:"/Mirage/docs/components/network-log-settings"}},i={},d=[{value:"Setup",id:"setup",level:3},{value:"Usage",id:"usage",level:3},{value:"Setting Player Ready",id:"setting-player-ready",level:4},{value:"Reacting to Ready changes",id:"reacting-to-ready-changes",level:4},{value:"Sending Messages to Ready Players",id:"sending-messages-to-ready-players",level:4},{value:"Resetting Ready",id:"resetting-ready",level:4}],c={toc:d};function y(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"ready-check-and-lobby-ready"},"Ready Check and Lobby Ready"),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"See the API reference for more details\n",(0,r.kt)("a",{parentName:"p",href:"/docs/reference/Mirage.Components/ReadyCheck"},"ReadCheck"),"\n",(0,r.kt)("a",{parentName:"p",href:"/docs/reference/Mirage.Components/LobbyReady"},"LobbyReady"))),(0,r.kt)("h3",{id:"setup"},"Setup"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Attach the ",(0,r.kt)("inlineCode",{parentName:"li"},"LobbyReady")," component to your network manager or other non-networked object."),(0,r.kt)("li",{parentName:"ol"},"Attach the ",(0,r.kt)("inlineCode",{parentName:"li"},"ReadyCheck")," component to your player's lobby object."),(0,r.kt)("li",{parentName:"ol"},"Ensure the ",(0,r.kt)("inlineCode",{parentName:"li"},"ReadyCheck")," component is configured to synchronize its ",(0,r.kt)("inlineCode",{parentName:"li"},"IsReady")," state from the owner client to the server, and from the server to all observers. This is typically handled by the ",(0,r.kt)("inlineCode",{parentName:"li"},"SyncVar")," attributes on the ",(0,r.kt)("inlineCode",{parentName:"li"},"IsReady")," field within the ",(0,r.kt)("inlineCode",{parentName:"li"},"ReadyCheck")," script, which ensures the value is set on the owner client and reset on the server when ",(0,r.kt)("inlineCode",{parentName:"li"},"LobbyReady.SetAllClientsNotReady()")," is called.")),(0,r.kt)("h3",{id:"usage"},"Usage"),(0,r.kt)("h4",{id:"setting-player-ready"},"Setting Player Ready"),(0,r.kt)("p",null,"To set a player as ready, you can simply update the ",(0,r.kt)("inlineCode",{parentName:"p"},"IsReady")," field of their ",(0,r.kt)("inlineCode",{parentName:"p"},"ReadyCheck"),' component to true. This can be done either manually through code, or through user input such as a "Ready" button. Mirage will then sync this change to server and other clients. For example:'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},"readyCheck.SetReady(true);\n")),(0,r.kt)("h4",{id:"reacting-to-ready-changes"},"Reacting to Ready changes"),(0,r.kt)("p",null,"When the ",(0,r.kt)("inlineCode",{parentName:"p"},"IsReady")," field of a player's ",(0,r.kt)("inlineCode",{parentName:"p"},"ReadyCheck")," component is changed, the ",(0,r.kt)("inlineCode",{parentName:"p"},"OnReadyChanged")," event is invoked on all clients to reflect the new value. You can subscribe to this event and perform actions based on the player's ready state. For example, you can update UI elements to show the player's current ready status:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},"public class ReadyUI : MonoBehaviour\n {\n     public ReadyCheck ReadyCheck;\n     public Image Image;\n\n     public void Start()\n     {\n         ReadyCheck.OnReadyChanged += OnReadyChanged;\n         // invoke right away to set the current value\n         OnReadyChanged(ReadyCheck.IsReady);\n     }\n\n     private void OnReadyChanged(bool ready)\n     {\n         Image.color = ready ? Color.green : Color.red;\n     }\n }\n")),(0,r.kt)("h4",{id:"sending-messages-to-ready-players"},"Sending Messages to Ready Players"),(0,r.kt)("p",null,"To send a message to all players that are ready, you can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"LobbyReady.SendToReady")," function. Here's an example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},'[NetworkMessage]\n // Make sure to regieter message on client\n public struct MyMessage\n {\n     public string message;\n }\n\n public class LobbyController : MonoBehaviour\n {\n     public LobbyReady LobbyReady;\n\n     public void SendToReady()\n     {\n         var myMessage = new MyMessage { message = "Hello, world!" };\n         // Send message to ready players\n         LobbyReady.SendToReady(myMessage);\n     }\n }\n')),(0,r.kt)("p",null,"You can also send messages to not ready players by setting the ",(0,r.kt)("inlineCode",{parentName:"p"},"sendToReady")," parameter to false. Note that this function only sends messages to players that have ",(0,r.kt)("inlineCode",{parentName:"p"},"ReadyCheck")," attached to their character and are synced with the server."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},'public void SendToNotReady()\n {\n     var myMessage = new MyMessage { message = "Hello, world!" };\n     // Send message to ready players\n     LobbyReady.SendToReady(myMessage, sendToReady: false);\n }\n')),(0,r.kt)("h4",{id:"resetting-ready"},"Resetting Ready"),(0,r.kt)("p",null,"Resetting Ready State for All Players\nYou can reset the ",(0,r.kt)("inlineCode",{parentName:"p"},"IsReady")," field for all players by calling ",(0,r.kt)("inlineCode",{parentName:"p"},"LobbyReady.SetAllClientsNotReady()"),". Here's an example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},"public void ClearReady()\n {\n     LobbyReady.SetAllClientsNotReady();\n }\n")),(0,r.kt)("p",null,"This will set the ",(0,r.kt)("inlineCode",{parentName:"p"},"IsReady")," field to ",(0,r.kt)("inlineCode",{parentName:"p"},"false")," for all ",(0,r.kt)("inlineCode",{parentName:"p"},"ReadyCheck")," on the server, the values will then be synced to client."))}y.isMDXComponent=!0}}]);