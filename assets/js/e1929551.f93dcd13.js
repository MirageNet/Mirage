"use strict";(self.webpackChunkmirage_docs=self.webpackChunkmirage_docs||[]).push([[9595],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var r=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=r.createContext({}),l=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=l(n),m=i,f=p["".concat(c,".").concat(m)]||p[m]||d[m]||a;return n?r.createElement(f,o(o({ref:t},u),{},{components:n})):r.createElement(f,o({ref:t},u))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,o=new Array(a);o[0]=p;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var l=2;l<a;l++)o[l]=n[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},23230:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>l});var r=n(87462),i=(n(67294),n(3905));const a={sidebar_position:8},o="Advanced Synchronization",s={unversionedId:"guides/sync/custom-serialization",id:"guides/sync/custom-serialization",title:"Advanced Synchronization",description:"In most cases, the use of SyncVars is enough for your game scripts to serialize their state to clients. However, in some cases, you might require more complex serialization code. This page is only relevant for advanced developers who need customized synchronization solutions that go beyond Mirage\u2019s normal SyncVar feature.",source:"@site/docs/guides/sync/custom-serialization.md",sourceDirName:"guides/sync",slug:"/guides/sync/custom-serialization",permalink:"/Mirage/docs/guides/sync/custom-serialization",draft:!1,editUrl:"https://github.com/MirageNet/Mirage/tree/main/doc/docs/guides/sync/custom-serialization.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8},sidebar:"docs",previous:{title:"Code Generation",permalink:"/Mirage/docs/guides/sync/code-generation"},next:{title:"Overview",permalink:"/Mirage/docs/guides/remote-actions/"}},c={},l=[{value:"Custom Serialization Functions",id:"custom-serialization-functions",level:2}],u={toc:l};function d(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"advanced-synchronization"},"Advanced Synchronization"),(0,i.kt)("p",null,"In most cases, the use of SyncVars is enough for your game scripts to serialize their state to clients. However, in some cases, you might require more complex serialization code. This page is only relevant for advanced developers who need customized synchronization solutions that go beyond Mirage\u2019s normal SyncVar feature."),(0,i.kt)("h2",{id:"custom-serialization-functions"},"Custom Serialization Functions"),(0,i.kt)("p",null,"To perform your own custom serialization, you can implement virtual functions on ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/Mirage/NetworkBehaviour"},"NetworkBehaviour")," to be used for SyncVar serialization. These functions are:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs"},"public virtual bool OnSerialize(NetworkWriter writer, bool initialState);\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cs"},"public virtual void OnDeserialize(NetworkReader reader, bool initialState);\n")),(0,i.kt)("p",null,"Use the ",(0,i.kt)("inlineCode",{parentName:"p"},"initialState")," flag to differentiate between the first time a game object is serialized and when incremental updates can be sent. The first time a game object is sent to a client, it must include a full state snapshot, but subsequent updates can save on bandwidth by including only incremental changes."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"OnSerialize")," function should return true to indicate that an update should be sent. If it returns true, the dirty bits for that script are set to zero. If it returns false, the dirty bits are not changed. This allows multiple changes to a script to be accumulated over time and sent when the system is ready, instead of every frame."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"OnSerialize")," function is only called for ",(0,i.kt)("inlineCode",{parentName:"p"},"initialState")," or when the ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/Mirage/NetworkBehaviour"},"NetworkBehaviour")," is dirty. A ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/Mirage/NetworkBehaviour"},"NetworkBehaviour")," will only be dirty if a ",(0,i.kt)("inlineCode",{parentName:"p"},"SyncVar")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"SyncObject")," (e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"SyncList"),") has changed since the last OnSerialize call. After data has been sent the ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/Mirage/NetworkBehaviour"},"NetworkBehaviour")," will not be dirty again until the next ",(0,i.kt)("inlineCode",{parentName:"p"},"syncInterval")," (set in the inspector). A ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/Mirage/NetworkBehaviour"},"NetworkBehaviour")," can also be marked as dirty by manually calling ",(0,i.kt)("inlineCode",{parentName:"p"},"SetDirtyBit")," (this does not bypass the ",(0,i.kt)("inlineCode",{parentName:"p"},"syncInterval")," limit)."),(0,i.kt)("p",null,"Although this works,  it is usually better to let Mirage generate these methods and provide ",(0,i.kt)("a",{parentName:"p",href:"/docs/guides/serialization/data-types"},"custom serializers")," for your specific field."))}d.isMDXComponent=!0}}]);