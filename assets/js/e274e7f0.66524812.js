"use strict";(self.webpackChunkmirage_docs=self.webpackChunkmirage_docs||[]).push([[798],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=o.createContext({}),l=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=l(e.components);return o.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=l(n),m=r,y=u["".concat(c,".").concat(m)]||u[m]||d[m]||i;return n?o.createElement(y,a(a({ref:t},p),{},{components:n})):o.createElement(y,a({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,a=new Array(i);a[0]=u;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:r,a[1]=s;for(var l=2;l<i;l++)a[l]=n[l];return o.createElement.apply(null,a)}return o.createElement.apply(null,n)}u.displayName="MDXCreateElement"},45704:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var o=n(87462),r=(n(67294),n(3905));const i={sidebar_position:13},a="Network Discovery",s={unversionedId:"components/network-discovery",id:"components/network-discovery",title:"Network Discovery",description:"This component has been moved from Mirage to a separate package. You can find it here//github.com/MirageNet/NetworkDiscovery",source:"@site/docs/components/network-discovery.md",sourceDirName:"components",slug:"/components/network-discovery",permalink:"/Mirage/docs/components/network-discovery",draft:!1,editUrl:"https://github.com/MirageNet/Mirage/tree/main/doc/docs/components/network-discovery.md",tags:[],version:"current",sidebarPosition:13,frontMatter:{sidebar_position:13},sidebar:"docs",previous:{title:"Network Ping Display",permalink:"/Mirage/docs/components/network-ping-display"},next:{title:"Ready Check and Lobby Ready",permalink:"/Mirage/docs/components/ready-check"}},c={},l=[{value:"Quick Start",id:"quick-start",level:2},{value:"Custom Network Discovery",id:"custom-network-discovery",level:2}],p={toc:l};function d(e){let{components:t,...i}=e;return(0,r.kt)("wrapper",(0,o.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"network-discovery"},"Network Discovery"),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("mdxAdmonitionTitle",{parentName:"admonition"},"[External Repository]"),(0,r.kt)("p",{parentName:"admonition"},"This component has been moved from Mirage to a separate package. You can find it here: ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/MirageNet/NetworkDiscovery"},"https://github.com/MirageNet/NetworkDiscovery"))),(0,r.kt)("p",null,"Suppose you are next to a friend. He starts a game in host mode and you want to join him. How will your phone locate his? Finding out his IP address is not exactly intuitive or something kids can do."),(0,r.kt)("p",null,'To solve this problem you can use Network Discovery. When your game starts, it sends a message in your current network asking "Is there any server available?". Any server within the same network will reply and provide information about how to connect to it.'),(0,r.kt)("p",null,"Mirage comes with a simple implementation of Network Discovery you can simply use in your game. It also provides a way for you to extend it so that you can pass additional data during the discovery phase."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Inspector",src:n(55319).Z,width:"819",height:"448"})),(0,r.kt)("p",null,"NetworkDiscovery and NetworkDiscoveryHUD components are included."),(0,r.kt)("p",null,"Network Discovery uses a UDP broadcast on the LAN enabling clients to find the running server and connect to it."),(0,r.kt)("p",null,"When a server is started, it listens on the UDP Broadcast Listen Port for requests from clients and returns a connection URI that clients apply to their transport."),(0,r.kt)("p",null,"You can adjust how often the clients send their requests out to find a server in seconds with the Active Discovery Interval."),(0,r.kt)("p",null,"The Server Found event must be assigned to a handler method, e.g. the OnDiscoveredServer method of NetworkDiscoveryHUD."),(0,r.kt)("p",null,"In the NetworkDiscoveryHUD, the NetworkDiscovery component should be assigned automatically."),(0,r.kt)("h2",{id:"quick-start"},"Quick Start"),(0,r.kt)("p",null,"To use Network Discovery follow these steps:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Create a game object with a NetworkManager if you have not done so already"),(0,r.kt)("li",{parentName:"ol"},"Do not add a NetworkManagerHUD. Discovery has a different UI component."),(0,r.kt)("li",{parentName:"ol"},"Add a NetworkDiscoveryHUD component to the NetworkManager game object.",(0,r.kt)("br",{parentName:"li"}),"A NetworkDiscovery component will be automatically added and wired up to your HUD."),(0,r.kt)("li",{parentName:"ol"},"Add a player to the NetworkManager if you have not done so."),(0,r.kt)("li",{parentName:"ol"},"Build and run a standalone version"),(0,r.kt)("li",{parentName:"ol"},"Click on Start Host"),(0,r.kt)("li",{parentName:"ol"},"Start play mode in the editor and click on Find Servers"),(0,r.kt)("li",{parentName:"ol"},"The editor should find the standalone version and display a button"),(0,r.kt)("li",{parentName:"ol"},"Click on the button to connect to it.")),(0,r.kt)("p",null,"The NetworkDiscoveryHUD is provided as a simple and quick way to get started, but you will probably want to replace it with your own user interface."),(0,r.kt)("h2",{id:"custom-network-discovery"},"Custom Network Discovery"),(0,r.kt)("p",null,"You can completely replace the user interface by adding your own interface (typically Unity UI based) instead of the default NetworkDiscoveryHUD. You do still need the NetworkDiscovery component to do the heavy lifting."),(0,r.kt)("p",null,"Sometimes you want to provide more information in the discovery messages. Some use cases could include:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The client can show if the server is in PvP or PvE mode"),(0,r.kt)("li",{parentName:"ul"},"The client can show how full the servers are."),(0,r.kt)("li",{parentName:"ul"},"The client can show the ping to each server so the player can choose the fastest server"),(0,r.kt)("li",{parentName:"ul"},"The client can show the language"),(0,r.kt)("li",{parentName:"ul"},"The client can show if the server is password protected")),(0,r.kt)("p",null,"The message classes define what is sent between the client and server. As long as you keep your messages simple using the ",(0,r.kt)("a",{parentName:"p",href:"/docs/guides/serialization/data-types"},"Data Types")," that Mirage can serialize, you won't need to write custom serializers for them."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},'public class DiscoveryRequest\n{\n    public string language="en";\n\n    // Add properties for whatever information you want sent by clients\n    // in their broadcast messages that servers will consume.\n}\n\npublic class DiscoveryResponse\n{\n    enum GameMode {PvP, PvE};\n\n    // you probably want uri so clients know how to connect to the server\n    public Uri uri;\n\n    public GameMode GameMode;\n    public int TotalPlayers;\n    public int HostPlayerName;\n\n    // Add properties for whatever information you want the server to return to\n    // clients for them to display or consume for establishing a connection.\n}\n')),(0,r.kt)("p",null,"The custom NetworkDiscovery class contains the overrides for handling the messages above."),(0,r.kt)("p",null,"You may want to refer to the NetworkDiscovery.cs script in the Components/Discovery folder to see how these should be implemented."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cs"},"public class NewNetworkDiscovery: NetworkDiscoveryBase<DiscoveryRequest, DiscoveryResponse> \n{\n    #region Server\n\n    protected override void ProcessClientRequest(DiscoveryRequest request, IPEndPoint endpoint)\n    {\n        base.ProcessClientRequest(request, endpoint);\n    }\n\n    protected override DiscoveryResponse ProcessRequest(DiscoveryRequest request, IPEndPoint endpoint) \n    {\n        // TODO: Create your response and return it   \n        return new DiscoveryResponse();\n    }\n\n    #endregion\n\n    #region Client\n\n    protected override DiscoveryRequest GetRequest()\n    {\n        return new DiscoveryRequest();\n    }\n\n    protected override void ProcessResponse(DiscoveryResponse response, IPEndPoint endpoint)\n    {\n        // TODO: a server replied,  do something with the response such as invoking a unityevent\n    }\n\n    #endregion\n}\n")))}d.isMDXComponent=!0},55319:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/NetworkDiscovery-9d0e24988d79acc3a8c32008078b8a7e.png"}}]);